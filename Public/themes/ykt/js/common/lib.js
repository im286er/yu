"use strict";define(function(require,exports,module){var $=require("jquery");$.fn.jdMarquee=function(n,t){"function"==typeof n&&(t=n,n={});var e,i=$.extend({deriction:"up",speed:10,auto:!1,width:null,height:null,step:1,control:!1,_front:null,_back:null,_stop:null,_continue:null,wrapstyle:"",stay:5e3,delay:20,dom:"div>ul>li".split(">"),mainTimer:null,subTimer:null,tag:!1,convert:!1,btn:null,disabled:"disabled",pos:{ojbect:null,clone:null}},n||{}),o=this.find(i.dom[1]),c=this.find(i.dom[2]);if("up"==i.deriction||"down"==i.deriction){var r=o.eq(0).outerHeight(),s=i.step*c.eq(0).outerHeight();o.css({width:i.width+"px",overflow:"hidden"})}if("left"==i.deriction||"right"==i.deriction){var l=c.length*c.eq(0).outerWidth();o.css({width:l+"px",overflow:"hidden"});var s=i.step*c.eq(0).outerWidth()}var d=function(){var n="<div style='position:relative;overflow:hidden;z-index:1;width:"+i.width+"px;height:"+i.height+"px;"+i.wrapstyle+"'></div>";switch(o.css({position:"absolute",left:0,top:0}).wrap(n),i.pos.object=0,e=o.clone(),o.after(e),i.deriction){default:case"up":o.css({marginLeft:0,marginTop:0}),e.css({marginLeft:0,marginTop:r+"px"}),i.pos.clone=r;break;case"down":o.css({marginLeft:0,marginTop:0}),e.css({marginLeft:0,marginTop:-r+"px"}),i.pos.clone=-r;break;case"left":o.css({marginTop:0,marginLeft:0}),e.css({marginTop:0,marginLeft:l+"px"}),i.pos.clone=l;break;case"right":o.css({marginTop:0,marginLeft:0}),e.css({marginTop:0,marginLeft:-l+"px"}),i.pos.clone=-l}i.auto&&(u(),o.hover(function(){f(i.mainTimer)},function(){u()}),e.hover(function(){f(i.mainTimer)},function(){u()})),t&&t(),i.control&&g()},u=function(n){f(i.mainTimer),i.stay=n?n:i.stay,i.mainTimer=setInterval(function(){p()},i.stay)},p=function(){f(i.subTimer),i.subTimer=setInterval(function(){v()},i.delay)},f=function(n){null!=n&&clearInterval(n)},m=function(n){n?(a(i._front).unbind("click"),a(i._back).unbind("click"),a(i._stop).unbind("click"),a(i._continue).unbind("click")):g()},g=function(){null!=i._front&&a(i._front).click(function(){a(i._front).addClass(i.disabled),m(!0),f(i.mainTimer),i.convert=!0,i.btn="front",p(),i.auto||(i.tag=!0),b()}),null!=i._back&&a(i._back).click(function(){a(i._back).addClass(i.disabled),m(!0),f(i.mainTimer),i.convert=!0,i.btn="back",p(),i.auto||(i.tag=!0),b()}),null!=i._stop&&a(i._stop).click(function(){f(i.mainTimer)}),null!=i._continue&&a(i._continue).click(function(){u()})},b=function(){i.tag&&i.convert&&(i.convert=!1,"front"==i.btn&&("down"==i.deriction&&(i.deriction="up"),"right"==i.deriction&&(i.deriction="left")),"back"==i.btn&&("up"==i.deriction&&(i.deriction="down"),"left"==i.deriction&&(i.deriction="right")),i.auto?u():u(4*i.delay))},h=function(n,t,a){a?(f(i.subTimer),i.pos.object=n,i.pos.clone=t,i.tag=!0):i.tag=!1,i.tag&&(i.convert?b():i.auto||f(i.mainTimer)),("up"==i.deriction||"down"==i.deriction)&&(o.css({marginTop:n+"px"}),e.css({marginTop:t+"px"})),("left"==i.deriction||"right"==i.deriction)&&(o.css({marginLeft:n+"px"}),e.css({marginLeft:t+"px"}))},v=function(){var n="up"==i.deriction||"down"==i.deriction?parseInt(o.get(0).style.marginTop):parseInt(o.get(0).style.marginLeft),t="up"==i.deriction||"down"==i.deriction?parseInt(e.get(0).style.marginTop):parseInt(e.get(0).style.marginLeft),c=Math.max(Math.abs(n-i.pos.object),Math.abs(t-i.pos.clone)),d=Math.ceil((s-c)/i.speed);switch(i.deriction){case"up":c==s?(h(n,t,!0),a(i._front).removeClass(i.disabled),m(!1)):(-r>=n&&(n=t+r,i.pos.object=n),-r>=t&&(t=n+r,i.pos.clone=t),h(n-d,t-d));break;case"down":c==s?(h(n,t,!0),a(i._back).removeClass(i.disabled),m(!1)):(n>=r&&(n=t-r,i.pos.object=n),t>=r&&(t=n-r,i.pos.clone=t),h(n+d,t+d));break;case"left":c==s?(h(n,t,!0),a(i._front).removeClass(i.disabled),m(!1)):(-l>=n&&(n=t+l,i.pos.object=n),-l>=t&&(t=n+l,i.pos.clone=t),h(n-d,t-d));break;case"right":c==s?(h(n,t,!0),a(i._back).removeClass(i.disabled),m(!1)):(n>=l&&(n=t-l,i.pos.object=n),t>=l&&(t=n-l,i.pos.clone=t),h(n+d,t+d))}};("up"==i.deriction||"down"==i.deriction)&&r>=i.height&&r>=i.step&&d(),("left"==i.deriction||"right"==i.deriction)&&l>=i.width&&l>=i.step&&d()}});