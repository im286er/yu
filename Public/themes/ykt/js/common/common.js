"use strict";define(function(require,exports,module){function i(i){$("body").append('<div id="'+i+'" class="m-loading"><div class="inside"><img src="/Public/themes/ykt/images/loading_2.gif"/></div></div>')}function t(i,t){$(t).empty().append('<div id="'+i+'" class="fa fa-spinner fa-spin m-fa-loading"></div>')}function n(i,t){var n=dialog({fixed:!0,okValue:"发 送",innerHTML:' <div class="loginTip-wrap">	<div class="hd">用户登录</div>		<div class="bd">		    <form id="formlogin">		        <ul>	            <li>	                <div class="label">手机/昵称：</div><span id="loginname_error" class="error"></span>	                <input id="J-item" name="loginname" class="u-input-text radius" type="text" placeholder="例:2233@example.com"/>	            </li>	            <li class="mt-15">	                <div class="label">密码：</div><span id="loginpwd_error" class="error"></span>	                <input id="J-pwd" class="u-input-text radius" type="password" name="loginpwd"/>	                <div class="forget">忘记密码?</div>	            </li>  	            <li class="r-form-list show-tips" id="J-show-tips">                  <p id="J-tips"></p>              </li>	        </ul>	        <input id="J-loginsubmit" class="login-btn u-btn u-btn-primary" type="button" value="登录"/>	        <div class="register">没有账号？<a href="#">马上注册</a></div>	    </form>		</div>	<div i="close" class="close"></div></div>',ok:function(){alert("成功")}});n.showModal();var a=$("#J-item"),s=$("#J-pwd"),l=$("#J-tips");i?i:i="",o(a,s,l,i,t),e(".u-input-text,.u-textarea")}function o(i,t,n,o,e){$("#J-loginsubmit").on("click",function(){var a=$.trim(i.val()),s=$.trim(t.val()),l=$(this);""==a||""==s?n.show().text("账号或密码不能为空"):(l.addClass("u-disabled").val("登录中"),$.ajax({url:"/Index/Login/doLogin",type:"POST",data:{item:a,pwd:s,jumpUrl:o},dataType:"json",success:function(i){i.code?e?e():window.location=i.jumpUrl:(n.show().text(i.msg),l.removeClass("u-disabled").val("登录"))}})),$(".r-f-input").on("blur",function(){var o=$.trim(i.val()),a=$.trim(t.val());""==o||""==a?n.show().text("账号或密码不能为空"):n.hide()})}),a(".loginTip-wrap","#J-loginsubmit")}function a(i,t){$(i).keypress(function(i){13==i.which&&$(t).click()})}function e(i){$(i).focus(function(){$(this).addClass("focus").removeClass("u-inputError")}),$(i).blur(function(){$(this).removeClass("focus")})}function s(i){return i.length>6&&/^[\w\-\.]+@[\w\-\.]+(\.\w+)+$/.test(i)}function l(i){return/^1[3,5,8]\d{9}$/.test(i)}function c(){var i;return $.ajax({url:"/Index/Login/isLogin",async:!1,dataType:"json"}).done(function(t){i=t.status}),i}function r(){$(".J-active").on("click",function(){$(this).addClass("active").siblings().removeClass("active")})}function d(i,t,n){$(i).on("click",function(){$(t).each(function(t,n){$(this).prop("checked",$(i).prop("checked"))}),n?n():""}),$(t).click(function(){var o=$(t);$(i).prop("checked",o.length==o.filter(":checked").length),n?n():""})}var $=require("jquery");require("artDialog");require("lazyload");exports.appendLoading=i,exports.faLoading=t,exports.LoginDialog=function(i,t){n(i,t)},exports.checkAccount=o,exports.AjaxUploadPic=function(i,t,n,o,a,e,s,l){var c=$(i),r=$(t),d="pic",u="one";new AjaxUpload(c,{action:yktGlobal.controller+"/upload/w/"+e+"/h/"+s,name:yktGlobal.controller,onSubmit:function(i,t){if("pic"==d){if(!t||!/^(jpg|png|jpeg|gif|JPG)$/.test(t))return r.text("文件格式错误，请上传格式为.png .jpg .jpeg 的图片").show(),!1;this.setData({info:"文件类型为图片"})}"one"==u&&this.disable()},onComplete:function(c,d){return d.indexOf("-")>0?(l?l(d,i,t,n,o,a,e,s):"",this.enable(),r.hide(),void 0):(r.text(d).show(),this.enable(),!1)}})},exports.returnLogin=a,exports.focusBlur=e,exports.isEmail=s,exports.isMobile=l,exports.isLogin=c,exports.highLight=r,exports.selectAll=function(i,t,n){d(i,t,n)},exports.toolbar=function(){function i(i){var t=$(document).height();$(i).css("height",t)}i("#J-toolbar"),yktGlobal.uid?($("body").click(function(){$("#J-toolbar").animate({right:0},500)}),$("#J-toolbar").click(function(i){$("#J-toolbar").animate({right:230},500),i.stopPropagation?i.stopPropagation():window.event&&(window.event.cancelBubble=!0)}),$("#J-user").click(function(i){i.stopPropagation?i.stopPropagation():window.event&&(window.event.cancelBubble=!0)}),$("#J-toolbar .cart").click(function(i){i.stopPropagation?i.stopPropagation():window.event&&(window.event.cancelBubble=!0)}),$(".toolbar-list .list-hd").mouseover(function(){$(this).children(".J-list-show").stop(!1,!1),$(this).children(".J-list-show").show(),$(this).children(".J-list-show").animate({right:"40px",opacity:"1"},300)}),$(".toolbar-list .list-hd").mouseout(function(){$(this).children(".J-list-show").stop(!1,!1),$(this).children(".J-list-show").animate({right:"80px",opacity:"0"},300),$(this).children(".J-list-show").hide()}),$(".J-toolbar-list-hd").click(function(){$(".list-bd").hide(),$(".J-toolbar-list-hd").removeClass("active"),$(this).addClass("active"),$(this).siblings(".J-toolbar-list-bd").show()}),$(".J-toolbar-dynamic-title").mouseover(function(){$(".J-toolbar-dynamic-info").hide(),$(".J-toolbar-dynamic-title").removeClass("active"),$(this).addClass("active"),$(this).children(".J-toolbar-dynamic-info").show()})):$(".toolbar-list").on("click",function(){n()})},$("#J-header-user").load("/Index/Login/info.html"),$(window).on("scroll",function(){$("img.m-lazy").each(function(){var i=$(this).offset().top,t=10,n=$(window).height()+$(window).scrollTop()+t,o=$(this).attr("data-original");n>=i&&o&&$(this).attr("src",o).removeAttr("data-original").hide().fadeIn(800).on("error",function(){$(this).attr("src","")})})}),$("body,html").animate({scrollTop:"1px"},100),$(".J-logined").on("click",function(i){$.ajax({url:"/Index/Login/isLogin",async:!1,dataType:"json"}).done(function(i){return i.status?void 0:(n(),!1)})});var u=$("#J-backtop");u.bind("click",function(){return $("html,body").animate({scrollTop:"0"},200),!1});var h=function(){var i=$(document).scrollTop(),t=$(window).height();i>500?u.css("visibility","visible"):u.css("visibility","hidden"),window.XMLHttpRequest||u.css("top",i+t-60)};$(window).bind("scroll",h),h(),exports.animateTo=function(i,t){$("body,html").animate({scrollTop:i+"px"},t)},$.event.special.valuechange={teardown:function(i){$(this).unbind(".valuechange")},handler:function(i){$.event.special.valuechange.triggerChanged($(this))},add:function(i){$(this).on("keyup.valuechange cut.valuechange paste.valuechange input.valuechange",i.selector,$.event.special.valuechange.handler)},triggerChanged:function(i){var t="true"===i[0].contentEditable?i.html():i.val(),n="undefined"==typeof i.data("previous")?i[0].defaultValue:i.data("previous");t!==n&&(i.trigger("valuechange",[i.data("previous")]),i.data("previous",t))}},$.yktTab=function(i,t,n,o,a){var e=$(i);e.removeClass(n),$(i).eq(a).addClass(n),$(t).hide(),$(t).eq(a).show(),e.on(o,function(){e.removeClass(n),$(this).addClass(n);var i=$(this).index();$(t).hide(),$(t).eq(i).show()})}});