"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};define(function(require){var $=require("jquery"),t=require("./popup"),e=require("./dialog-config"),n=e.cssUri;if(n){var i=require[require.toUrl?"toUrl":"resolve"];i&&(n=i(n),n='<link rel="stylesheet" href="'+n+'" />',$("base")[0]?$("base").before(n):$("head").append(n))}var o=0,s=new Date-0,a=!("minWidth"in $("html")[0].style),r="createTouch"in document&&!("onmousemove"in document)||/(iPhone|iPad|iPod)/i.test(navigator.userAgent),c=!a&&!r,u=function h(t,e,n){var i=t=t||{};"string"!=typeof t&&1!==t.nodeType||(t={content:t,fixed:!r}),t=$.extend(!0,{},h.defaults,t),t.original=i;var a=t.id=t.id||s+o,u=h.get(a);return u?u.focus():(c||(t.fixed=!1),t.quickClose&&(t.modal=!0,t.backdropOpacity=0),$.isArray(t.button)||(t.button=[]),void 0!==n&&(t.cancel=n),t.cancel&&t.button.push({id:"cancel",value:t.cancelValue,callback:t.cancel,display:t.cancelDisplay}),void 0!==e&&(t.ok=e),t.ok&&t.button.push({id:"ok",value:t.okValue,callback:t.ok,autofocus:!0}),h.list[a]=new h.create(t))},d=function(){};d.prototype=t.prototype;var l=u.prototype=new d;return u.create=function(e){var n=this;$.extend(this,new t);var i=(e.original,$(this.node).html(e.innerHTML)),s=$(this.backdrop);return this.options=e,this._popup=i,$.each(e,function(t,e){"function"==typeof n[t]?n[t](e):n[t]=e}),e.zIndex&&(t.zIndex=e.zIndex),i.attr({"aria-labelledby":this._$("title").attr("id","title:"+this.id).attr("id"),"aria-describedby":this._$("content").attr("id","content:"+this.id).attr("id")}),this._$("close").css("display",this.cancel===!1?"none":"").attr("title",this.cancelValue).on("click",function(t){n._trigger("cancel"),t.preventDefault()}),this._$("dialog").addClass(this.skin),this._$("body").css("padding",this.padding),e.quickClose&&s.on("onmousedown"in document?"mousedown":"click",function(){return n._trigger("cancel"),!1}),this.addEventListener("show",function(){s.css({opacity:0,background:e.backdropBackground}).animate({opacity:e.backdropOpacity},150)}),this._esc=function(e){var i=e.target,o=i.nodeName,s=/^input|textarea$/i,a=t.current===n,r=e.keyCode;!a||s.test(o)&&"button"!==i.type||27===r&&n._trigger("cancel")},$(document).on("keydown",this._esc),this.addEventListener("remove",function(){$(document).off("keydown",this._esc),delete u.list[this.id]}),o++,u.oncreate(this),this},u.create.prototype=l,$.extend(l,{content:function(t){var e=this._$("content");return"object"===("undefined"==typeof t?"undefined":_typeof(t))?(t=$(t),e.empty("").append(t.show()),this.addEventListener("beforeremove",function(){$("body").append(t.hide())})):e.html(t),this.reset()},title:function(t){return this._$("title").text(t),this._$("header")[t?"show":"hide"](),this},width:function(t){return this._$("content").css("width",t),this.reset()},height:function(t){return this._$("content").css("height",t),this.reset()},button:function(t){t=t||[];var e=this,n="",i=0;return this.callbacks={},"string"==typeof t?(n=t,i++):$.each(t,function(t,o){var s=o.id=o.id||o.value,a="";e.callbacks[s]=o.callback,o.display===!1?a=' style="display:none"':i++,n+='<button type="button" i-id="'+s+'"'+a+(o.disabled?" disabled":"")+(o.autofocus?' autofocus class="ui-dialog-autofocus"':"")+">"+o.value+"</button>",e._$("button").on("click","[i-id="+s+"]",function(t){var n=$(this);n.attr("disabled")||e._trigger(s),t.preventDefault()})}),this._$("button").html(n),this._$("footer")[i?"show":"hide"](),this},statusbar:function(t){return this._$("statusbar").html(t)[t?"show":"hide"](),this},_$:function(t){return this._popup.find("[i="+t+"]")},_trigger:function(t){var e=this.callbacks[t];return"function"!=typeof e||e.call(this)!==!1?this.close().remove():this}}),u.oncreate=$.noop,u.getCurrent=function(){return t.current},u.get=function(t){return void 0===t?u.list:u.list[t]},u.list={},u.defaults=e,u});